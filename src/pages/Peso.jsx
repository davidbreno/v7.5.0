import { useState } from 'react'
import { Link } from 'react-router-dom'
import Sidebar from '../components/Sidebar'
import Modal from '../components/Modal'
import { addWeight, updateWeight, deleteWeight, load } from '../data/store'
function Header({ title }){ return (<header className="topbar"><div className="brand">{title}</div><nav className="menu"><Link to="/">Dashboard</Link></nav></header>) }
export default function Peso(){ const [data,setData]=useState(load()); const [editing,setEditing]=useState(null); function submitNew(e){e.preventDefault(); const f=new FormData(e.currentTarget); setData(addWeight({ data:f.get('data'), kg:Number(f.get('kg')) })); e.currentTarget.reset()} function submitEdit(e){e.preventDefault(); const f=new FormData(e.currentTarget); setData(updateWeight(editing.id,{ data:f.get('data'), kg:Number(f.get('kg')) })); setEditing(null)} function remove(id){ setData(deleteWeight(id)) } return (<div className="layout"><Sidebar /><div><Header title="Peso" /><div className="wrap"><div className="widget"><h3 className="font-semibold mb-2">Adicionar</h3><form onSubmit={submitNew} className="grid grid-cols-2 md:grid-cols-5 gap-2"><input name="data" type="date" className="bg-[color:var(--panel)] border border-white/10 rounded px-3 py-2" required /><input name="kg" type="number" step="0.1" placeholder="Peso (kg)" className="bg-[color:var(--panel)] border border-white/10 rounded px-3 py-2" required /><button className="rounded text-white font-semibold px-4 md:col-span-1 col-span-2" style={{background:'linear-gradient(90deg,var(--brand1),var(--brand2),var(--brand3))'}}>Salvar</button></form></div><div className="widget"><h3 className="font-semibold mb-2">Registros</h3><table className="w-full text-sm"><thead className="text-white/80"><tr><th className="text-left py-2">Data</th><th className="text-left">Peso (kg)</th><th></th></tr></thead><tbody>{data.saude.peso.map(p=>(<tr key={p.id} className="border-t border-white/10"><td className="py-2">{p.data}</td><td>{p.kg}</td><td className="text-right"><button onClick={()=>setEditing(p)} className="px-3 py-1 rounded bg-white/10 hover:bg-white/20 mr-2">Editar</button><button onClick={()=>remove(p.id)} className="px-3 py-1 rounded bg-red-500/70 hover:bg-red-500/90">Apagar</button></td></tr>))}{data.saude.peso.length===0&&<tr><td colSpan={3} className="text-center py-6 text-white/60">Sem dados.</td></tr>}</tbody></table></div></div></div><Modal open={!!editing} title="Editar Peso" onClose={()=>setEditing(null)}><form onSubmit={submitEdit} className="grid grid-cols-2 gap-2"><input name="data" type="date" defaultValue={editing?.data} className="bg-[color:var(--panel)] border border-white/10 rounded px-3 py-2" /><input name="kg" type="number" step="0.1" defaultValue={editing?.kg} className="bg-[color:var(--panel)] border border-white/10 rounded px-3 py-2" /><button className="rounded text-white font-semibold px-4" style={{background:'linear-gradient(90deg,var(--brand1),var(--brand2),var(--brand3))'}}>Salvar</button></form></Modal></div>) }